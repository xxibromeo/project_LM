// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model LMTimesheetRecords {
  id                    Int        @id @unique @default(autoincrement())
  date                  DateTime   @default(now()) // วันที่บันทึก
  subSite               String
  siteCode              String
  siteName              String
  numberOfPeople        Int // จำนวนคนตามสัญญา
  dailyWorkingEmployees Int //ตามวันที่กำนดมา
  workingPeople         Int //กรอกเองจำนวนที่ไปทำงาน
  businessLeave         Int
  sickLeave             Int
  peopleLeave           Int
  overContractEmployee  Int //เกินสัญญา
  replacementEmployee   Int
  replacementNames      String[]
  remark                String
  nameadmin             String
  createdAt             DateTime   @default(now())
  updateAt              DateTime   @updatedAt
  // สร้างความสัมพันธ์กับ Site
  site                  Site      @relation(fields: [siteCode], references: [siteCode])
}

model Site {
  id                 Int               @id @unique @default(autoincrement())
  siteCode           String             @unique // ทำให้ sitecode เป็น unique เพื่อเชื่อมโยงกับ LMTimesheetRecords ได้
  siteName           String
  clientName         String
  startDate          DateTime           @default(now()) //วันที่เริ่มสัญญา
  endDate            DateTime             @default(now())
  numberOfPeople     Int
  penaltyRate        Int //ค่าปรับ?
  typeSite           String
  adminWage          String //ธุรการ(ค่าแรง)
  siteSupervisorName String
  LMTimesheetRecords LMTimesheetRecords[]// เชื่อมโยงกลับจาก LMTimesheetRecords
  SiteEmployees      SiteDayOff[]
  createdAt          DateTime             @default(now())
  updateAt           DateTime             @updatedAt
}

model SiteDayOff {
  id                    Int                  @id @unique @default(autoincrement())
  workDate              DateTime             @default(now())
  subSite               String @unique
  siteCode              String
  siteName              String
  typeSite              String
  numberOfPeople        Int
  penaltyRate           Int //ค่าปรับ
  dailyWorkingEmployees Int
  site                  Site                 @relation(fields: [siteCode], references: [siteCode])
  
}
